<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security" 
xmlns:beans="http://www.springframework.org/schema/beans" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security.xsd"> 

	<!-- 검사 URL --> 
	<http use-expressions="true"> 
		<intercept-url pattern="/login/login" access="permitAll" /> 
		<intercept-url pattern="/home" access="permitAll" /> 
		<intercept-url pattern="/admin/**" access="hasRole('ADMIN')" /> 
		<intercept-url pattern="/**" access="hasAnyRole('USER, ADMIN')" /> 
		<form-login 
			login-page="/login/login" 
			default-target-url="/home" 
			authentication-failure-url="/login/login?error" 
			username-parameter="id" 
			password-parameter="password" /> 
		<logout 
			logout-url="/logout" 
			logout-success-url="/home" /> 
		<access-denied-handler error-page="/login/accessDenied" /> 
	</http>
	
	<!-- provider --> 
	<authentication-manager> 
		<authentication-provider> 
			<jdbc-user-service 
				data-source-ref="dataSource" 
				role-prefix="" 
				users-by-username-query="
											select 
												username
												, password
												, enabled 
											from 
												users 
											where 
												username = ?
				" 
				authorities-by-username-query="
												select 
													username
													, authority 
												from 
													authorities 
												where 
													username = ?
				"
				group-authorities-by-username-query="
												select 
													g.id
													, g.group_name
													, ga.authority 
												from 
													groups g
													join group_members gm on g.id = gm.group_id
													join group_authorities ga on g.id = ga.group_id  
												where 
													gm.username = ? " /> 
		</authentication-provider> 
	</authentication-manager>
</beans:beans>